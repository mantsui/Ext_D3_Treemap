<!DOCTYPE html>
<meta charset="utf-8">

<head>
	<!-- jQuery -->
	<script src="https://code.jquery.com/jquery-3.2.1.min.js"></script>

	<!-- Bootstrap -->
	<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" >
	<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" ></script>

	<script src="https://d3js.org/d3.v5.min.js"></script>
	
	<style>
		.axis path,
		.axis line {
		  fill: none;
		  stroke: #000;
		  shape-rendering: crispEdges;
		}
		.axis text {
		  font: 10px sans-serif;
		}
		
		g.hidden line,
		g.hidden path{
		  display: none;
		}
		g.tick line {
		  stroke: blue;
		}
		g.tick text {
		  font-size: 12px;
		  fill: purple;
		}
	</style>
	
</head>

<body>
<!--h4>Tableau Extension API Test - D3 Sunburst Test</h4--->

<!-- SVG content -->
<div id="D3_Chart"></div>
	
<div id="configure" hide>
	<h3>Please Configure this custom Extension</h3>
	<ul>
		<li>Click on the down arrow in the Extension menu (look right)</li>
		<li>Select on Configure...</li>
		<li>Check the Extension details and click Allow</li>
		<li>Choose your settings</li>
		<li>Enjoy</li>
	</ul>  
</div>
	
<script>
	'use strict';
	// Wrap everything in an anonymous function to avoid polluting the global namespace
	(function () {
		
		// These variables will hold a reference to the unregister Event Listener functions.
		// https://tableau.github.io/extensions-api/docs/interfaces/dashboard.html#addeventlistener
		let unregisterSettingsEventListener = null;
		var dict_Settings = [];
		
		$(document).ready(function () {
			// Added new code here to point to the configure function.
			tableau.extensions.initializeAsync({ 'configure':configure }).then(function () {
				getData_to_D3();
				
				// Add settings listener here
				// Help refresh the chart upon save from configuration dialog
				unregisterSettingsEventListener = tableau.extensions.settings.addEventListener(tableau.TableauEventType.SettingsChanged, (settingsEvent) => {
					getData_to_D3();
				});

			}, function () { console.log('Error while Initializing: ' + err.toString()); });
		});		
		
		function getData_to_D3() {

		const worksheets=tableau.extensions.dashboardContent.dashboard.worksheets;
		// We will try to read the worksheet from the settings, if this exists we will show
		// the configuration screen, otherwise we will clear the table and destroy the
		// reference.
			
		var sheetName = tableau.extensions.settings.get("worksheet");
		//console.log('tableau.extensions.settings.get("worksheet") Worksheet Name: ' + sheetName);
		if (sheetName == undefined || sheetName =="" || sheetName == null) {
			$("#configure").show();
			configure();
			//$("#datatable").text("");
			//if( tableReference !== null) {
				//tableReference.destroy();
			//}
			// Exit the function if no worksheet name is present !!!
			return;
		} else {
			// If a worksheet is selected, then we hide the configuration screen.
			$("#configure").hide();
		}
			
		// Use the worksheet name saved in the Settings to find and return
		// the worksheet object.
		var worksheet=worksheets.find(function (sheet) { 
			return sheet.name===sheetName;
		});
					
		var strMeasureName = tableau.extensions.settings.get("MeasureName");

		var regExp = /\(([^)]+)\)/;
		var regExpMatches = regExp.exec(strMeasureName);
		//matches[1] contains the value between the parentheses
		var strDisplayName = regExpMatches[1];
			
		dict_Settings = tableau.extensions.settings.getAll();
		console.log('dict_Settings: ', dict_Settings);

		var Ordered_Dimensions = [];
		for(var key in dict_Settings) {
			var value = dict_Settings[key];

			if (key.startsWith('FieldName_')){
				Ordered_Dimensions.push(value);
			}
		}
		console.log('----- Ordered_Dimensions -----', Ordered_Dimensions);	// Debug output
			
		worksheet.getSummaryDataAsync().then(function (sumdata) {
			var worksheetData = sumdata.data;			
			console.log('----- sumdata.data -----', worksheetData);
						
			// Convert Tableau data into Array of Objects for D3 processing.
			var Tableau_Array_of_Objects = ReduceToObjectTablulated(sumdata);
			console.log('----- Display Tableau_Array_of_Objects -----', Tableau_Array_of_Objects);	// Debug output
			
			// Add placeholder if this is a one dimension, one measure dataset
			// This is to help ensure proper d3 chart drawing for one-dimension dataset
			//if(Ordered_Dimensions.length == 1) {
			//   	Ordered_Dimensions.splice(0, 0, 'placeholder');
			//	console.log('Spliced dimensions: ', Ordered_Dimensions);
			//}
			
			var uniqEleCount = uniqueElementCnt(Tableau_Array_of_Objects, Ordered_Dimensions);
			
			var TableauTreeData = Convert_To_TreeData(Tableau_Array_of_Objects, Ordered_Dimensions, strMeasureName, strDisplayName);
			console.log('----- Display Tree Data -----', TableauTreeData);	// Debug output

			var colorScale = tableau.extensions.settings.get("chartColorScale");

			draw_D3(TableauTreeData, strDisplayName, Ordered_Dimensions, uniqEleCount, colorScale);
		});
		}
		
		// This opens the configuration window.
		function configure() {
			const popupUrl = `https://mantsui.github.io/Ext_D3_Sunburst_Test_ConfigDialog`;
			let defaultPayload = "";
			tableau.extensions.ui.displayDialogAsync(popupUrl, defaultPayload, { height:700, width:500 }).then((closePayload) => {
				drawD3chart();
			}).catch((error) => {
				switch (error.errorCode) {
					case tableau.ErrorCodes.DialogClosedByUser:
					console.log("Dialog was closed by user");
					break;
				default:
					console.error(error.message);
			}
			});
		}
		
		// Passing uniqueElementCount to help with the color contrast
		function draw_D3(nodeData, MeasureName, DimensionList, uniqueElementCount, colorChromaticScale){
			
			var window_Width = window.innerWidth || document.documentElement.clientWidth || document.body.clientWidth;
			var window_Height = window.innerHeight || document.documentElement.clientHeight || document.body.clientHeight;
			
			// Define the dimensions of the visualization.
			var width = Math.min(window_Width, window_Height),
			height = Math.min(window_Width, window_Height),
			radius = (Math.min(width, height) / 2);
			/* Define the scales that will translate data values into visualization 
				 properties. The "x" scale will represent angular position within the
				 visualization, so it ranges linearly from 0 to 2π. The "y" scale will 
				 represent area, so it ranges from 0 to the full radius of the
				 visualization. Since area varies as the square of the radius, 
				 this scale takes the square root of the input domain before mapping to
				 the output range.  */
			var x = d3.scaleLinear()
					.range([0, 2 * Math.PI]);
			var y = d3.scaleSqrt()
					.range([0, radius]);

			var arrStepColors = steppedColorArray(colorChromaticScale, uniqueElementCount);
			var color = d3.scaleOrdinal(arrStepColors);
			
			// Declare Data structure
			var partition = d3.partition();
			// Size arcs
			var arc = d3.arc()
					.startAngle(function(d) { return Math.max(0, Math.min(2 * Math.PI, x(d.x0))); })
					.endAngle(function(d) { return Math.max(0, Math.min(2 * Math.PI, x(d.x1))); })
					.innerRadius(function(d) { return Math.max(0, y(d.y0)); })
					.outerRadius(function(d) { return Math.max(0, y(d.y1)); });
			//Remove and create svg for chart refreshing
			d3.select("svg").remove();	  
			/* Create the SVG container for the visualization and define its 
				 dimensions. Within that container, add a group element (`<g>`) 
				 that can be transformed via a translation to account for the 
				 margins and to center the visualization in the container.*/

			var svg = d3.select("#D3_Chart")
					.append("svg")
					.attr("width", width)
					.attr("height", height)
					.append("g")
					.attr("transform", "translate(" + width / 2 + "," + (height / 2) + ")");
			d3.select("#D3_Chart").attr("align","center");
			
			// Find data root
			var root = d3.hierarchy(nodeData);
			root.sum(function(d) { return d.size; });
			//console.log('----- root data -----', root); // Debug output
			
			svg.selectAll("path")
			.data(partition(root).descendants())
			.enter().append("path")
			.attr("d", arc)
			//.style("fill", function(d) { return color((d.children ? d : d.parent).data.name); })
			.style("fill", function(d) { return color(d.data.name); })
			.attr("stroke", "white")	// Set separator-line color
			.attr("stroke-width", Initial_StrokeWidth)
			//.attr("stroke-width", 0.5)	// Set separator-line thickness
			.on("click", click)		// Initiate D3 event listener for mouse click on D3 chart
			.append("title")
			.text( Text_ToolTip );		// Initiate and call text tooltip


			var filterSheet = '';
			if( tableau.extensions.settings.get("FilterSheet") != null) {
				filterSheet = tableau.extensions.settings.get("FilterSheet");
			}

			var Filter_Dimensions = [];
			for(var key in dict_Settings) {
				var value = dict_Settings[key];

				if (key.startsWith('FilterFieldName_')){
					Filter_Dimensions.push(value);
				}
			}

			// Function for click event  
			function click(d) {
				
				var clickDepth = d.depth;
				var arrValue = [];				
				arrValue.push(d.data.name);
				
				svg.transition()
					.duration(750)
					.tween("scale", function() {
						var xd = d3.interpolate(x.domain(), [d.x0, d.x1]),
						yd = d3.interpolate(y.domain(), [d.y0, 1]),
						yr = d3.interpolate(y.range(), [d.y0 ? 20 : 0, radius]);
						return function(t) { x.domain(xd(t)); y.domain(yd(t)).range(yr(t)); };
					})
					.selectAll("path")
					//.style("stroke-width", 1.5 / k + "px")
					//.style("stroke-width", Dynamic_StrokeWidth(d, clickDepth))
					.attrTween("d", function(d) { return function() { return arc(d); }; });
				
				
				if(clickDepth == 0) {
					if(filterSheet != ''){
						resetFilter( filterSheet, DimensionList.slice(clickDepth), Filter_Dimensions );
					}
				} else {
					if(filterSheet != ''){
						// Optional apply filter function to target sheet in dashboard
						resetFilter( filterSheet, DimensionList.slice(clickDepth), Filter_Dimensions );
						if( Filter_Dimensions.includes(DimensionList[clickDepth - 1]) ) {
							setFilterTo( filterSheet, DimensionList[clickDepth - 1], arrValue);
						}
					}
				}
			}
			// Create text tooltip for D3 Chart
			function Text_ToolTip(d){
				var Value_Field_Name = MeasureName;
				var Tooltip = ""; 
				var formatComma = d3.format(",");
				// Define whether dollar sign display on tooltip
				var DollarSign = "";
				// Add dollar sign to tooltip if value is not "Sales" isDollarSign
				//if( Value_Field_Name.toUpperCase().indexOf("SALES") === -1 ) {
				if( dict_Settings[isDollarSign] == "true" ) {
					DollarSign = "$";
				}
				Tooltip = d.data.name + "\n" + Value_Field_Name + ": " + DollarSign + formatComma(d.value);
				//console.log("Height: " + d.height);			// Debug output
				//console.log("Depth: " + d.depth);			// Debug output
				//console.log("Value_Field_Name: " + d.data.name);	// Debug output
				//console.log("Value: " + d.value);			// Debug output
				//console.log("Size: " + d.data.size);			// Debug output
				return Tooltip;
			}
			
			function Initial_StrokeWidth(d){
				var intWidth = 0.5;
				if (d.depth > 3) {
					intWidth = 0.0;	// Hide stroke width on deeper layers of sunburst nodes
				}
				return intWidth;
			}
			function Dynamic_StrokeWidth(d, intDepth){
				console.log('Click Depth: ', intDepth);
				//console.log('d.depth: ', d.depth);
				var intWidth = 0.5;
				if (d.depth > 3 && intDepth <= 3) {
					intWidth = 0.0;	// Hide stroke width on deeper layers of sunburst nodes
					console.log('Hiding deeper levels intDept: ', intDepth);
				}
				/*else if (d.depth > 3 && intDepth > 3) {
					 intWidth = 0.5;
				}*/
				return intWidth;
			}		
		}
		
		// Tableau .getData() returns an array (rows) of arrays (columns) of objects, 
		// which have a formattedValue property.
		// Convert and flatten "Array of Arrays" to "Array of objects" in 
		// field:values convention for easier data format for D3.
		// This is also for understandability to imitate the closest form of tablulated data format.
		function ReduceToObjectTablulated(TableauData){
			var Array_Of_Objects = [];
			
			for (var RowIndex = 0; RowIndex < TableauData.data.length; RowIndex++) {
				var SingleObject = new Object();
				for (var FieldIndex = 0; FieldIndex < TableauData.data[RowIndex].length; FieldIndex++) {
					var FieldName = TableauData.columns[FieldIndex].fieldName;
					SingleObject[FieldName] = TableauData.data[RowIndex][FieldIndex].value;
				}//Looping through the object number of properties (aka: Fields) in object
				
				Array_Of_Objects.push(SingleObject);	// Dynamically append object to the array
				//console.log(' ----- Single Object -----');	// Debug output
				//console.log(SingleObject);			// Debug output
				//console.log(Array_Of_Objects);		// Debug output
			} //Looping through data array of objects.
			
			if(Object.keys(Array_Of_Objects[0]).length == 2) {
				for (var index = 0; index < Array_Of_Objects.length; index++) {
					Array_Of_Objects[index].placeholder = ' ';
				}
			}
			//console.log(' ----- Display Array_Of_Objects ----- ');// Debug output
			//console.log(Array_Of_Objects);			// Debug output
			//console.log('Number of properties: ', Object.keys(Array_Of_Objects[0]).length);
			return Array_Of_Objects;
		}
		
		// Convert tablulated data into hierarchical data for most advanced D3 charts
		// Not all D3 charts requires hierarchical data as input (ie: simple D3 line chart, simple D3 bar chart)
		function Convert_To_TreeData(FlatData, arrayDimensionNames, strValueName, strDisplayValue){
			// Clone a local array of Dimension Names so the array argument is pass by value and not by pass reference
			var localArrayDimensionNames = arrayDimensionNames.slice();
			var TreeData = { name : strDisplayValue, children : [] };
			var final_Child_Level = localArrayDimensionNames.pop();
			var non_Final_Children_Levels = localArrayDimensionNames;
			// Convert tabulated data to tree data.
			// For each data row, loop through the expected levels traversing the output tree
			FlatData.forEach(function(d){
				// Keep this as a reference to the current level
				var depthCursor = TreeData.children;
				// Go down one level at a time
				non_Final_Children_Levels.forEach(function( property, depth ){
					// Look to see if a branch has already been created
					var index;
					depthCursor.forEach(function(child,i){
						if ( d[property] == child.name ) index = i;
					});
					// Add a branch if it isn't there
					if ( isNaN(index) ) {
						depthCursor.push({ name : d[property], children : []});
						index = depthCursor.length - 1;
					}
					// Now reference the new child array as we go deeper into the tree
					depthCursor = depthCursor[index].children;
					// This is a leaf, so add the last element to the specified branch
					//Remove all commas in a text string
					var TempString = d[strValueName].replace(/,/g,"");
					var Target_Key = Math.round(+TempString); //Convert String to Numeric
					if ( depth === non_Final_Children_Levels.length - 1 ) {
						depthCursor.push({ name : d[final_Child_Level], size : Target_Key });
					}
				});
			});
			return TreeData;
		}		
		
		// Function for dynamic sorting
		function compareValues(key, order='asc') {
  			return function(a, b) {
    				if(!a.hasOwnProperty(key) || !b.hasOwnProperty(key)) {
      				// property doesn't exist on either object
      				return 0
				}

				const varA = (typeof a[key] === 'string') ? a[key].toUpperCase() : a[key];
				const varB = (typeof b[key] === 'string') ? b[key].toUpperCase() : b[key];

				let comparison = 0;
				if (varA > varB) {
					comparison = 1;
				} else if (varA < varB) {
					comparison = -1;
				}
				return ( (order == 'desc') ? (comparison * -1) : comparison );
			};
		}

		// Function to help force array of distinct elements
		const distinct = (value, index, self) => {
			return self.indexOf(value) === index;
		}
		
		// Function to count the number of unique dimension elements
		// This is to help design the color contrast
		function uniqueElementCnt(inputArr, dimensionList){
			var uniqueList = [];
			for (var RowIndex = 0; RowIndex < inputArr.length; RowIndex++) {
				for(var ColIndex = 0; ColIndex < dimensionList.length; ColIndex++) {
					uniqueList.push(inputArr[RowIndex][dimensionList[ColIndex]]);
				}
			}
			uniqueList = uniqueList.filter(distinct);
			return uniqueList.length;
		}
		
		// Established stepped color scale to help the color constrast of the D3 chart
		function steppedColorArray(ColorScaleType, uniqueElementCount) {
			var steppedColorScale = [];
			for(var RowIndex = 0; RowIndex < uniqueElementCount; RowIndex++){
				//
				switch(ColorScaleType) {
					case 'Brown_BrightGreen':
						steppedColorScale.push(d3.interpolateBrBG(RowIndex / uniqueElementCount));
						break;
					case 'Purple_Green':
						steppedColorScale.push(d3.interpolatePRGn(RowIndex / uniqueElementCount));
						break;
					case 'Pink_YellowGreen':
						steppedColorScale.push(d3.interpolatePiYG(RowIndex / uniqueElementCount));
						break;
					case 'Purple_Orange':
						steppedColorScale.push(d3.interpolatePuOr(RowIndex / uniqueElementCount));
						break;
					case 'Red_Blue':
						steppedColorScale.push(d3.interpolateRdBu(RowIndex / uniqueElementCount));
						break;
					case 'Red_Grey':
						steppedColorScale.push(d3.interpolateRdGy(RowIndex / uniqueElementCount));
						break;
					case 'Red_Yellow_LightBlue':
						steppedColorScale.push(d3.interpolateRdYlBu(RowIndex / uniqueElementCount));
						break;
					case 'Red_Yellow_LightGreen':
						steppedColorScale.push(d3.interpolateRdYlGn(RowIndex / uniqueElementCount));
						break;
					case 'Spectral':
						steppedColorScale.push(d3.interpolateSpectral(RowIndex / uniqueElementCount));
						break;
					case 'Blues':
						steppedColorScale.push(d3.interpolateBlues(RowIndex / uniqueElementCount));
						break;
					case 'Greens':
						steppedColorScale.push(d3.interpolateGreens(RowIndex / uniqueElementCount));
						break;
					case 'Greys':
						steppedColorScale.push(d3.interpolateGreys(RowIndex / uniqueElementCount));
						break;
					case 'Oranges':
						steppedColorScale.push(d3.interpolateOranges(RowIndex / uniqueElementCount));
						break;
					case 'Purples':
						steppedColorScale.push(d3.interpolatePurples(RowIndex / uniqueElementCount));
						break;
					case 'Reds':
						steppedColorScale.push(d3.interpolateReds(RowIndex / uniqueElementCount));
						break;
					case 'Viridis':
						steppedColorScale.push(d3.interpolateViridis(RowIndex / uniqueElementCount));
						break;
					case 'Inferno':
						steppedColorScale.push(d3.interpolateInferno(RowIndex / uniqueElementCount));
						break;
					case 'Magma':
						steppedColorScale.push(d3.interpolateMagma(RowIndex / uniqueElementCount));
						break;
					case 'Plasma':
						steppedColorScale.push(d3.interpolatePlasma(RowIndex / uniqueElementCount));
						break;
					case 'Warm':
						steppedColorScale.push(d3.interpolateWarm(RowIndex / uniqueElementCount));
						break;
					case 'Cool':
						steppedColorScale.push(d3.interpolateCool(RowIndex / uniqueElementCount));
						break;
					case 'Cube_Helix':
						steppedColorScale.push(d3.interpolateCubehelixDefault(RowIndex / uniqueElementCount));
						break;
					case 'Blue_Green':
						steppedColorScale.push(d3.interpolateBuGn(RowIndex / uniqueElementCount));
						break;
					case 'Blue_Purple':
						steppedColorScale.push(d3.interpolateBuPu(RowIndex / uniqueElementCount));
						break;
					case 'Green_Blue':
						steppedColorScale.push(d3.interpolateGnBu(RowIndex / uniqueElementCount));
						break;
					case 'Orange_Red':
						steppedColorScale.push(d3.interpolateOrRd(RowIndex / uniqueElementCount));
						break;
					case 'Purple_Blue_Green':
						steppedColorScale.push(d3.interpolatePuBuGn(RowIndex / uniqueElementCount));
						break;
					case 'Purple_Blue':
						steppedColorScale.push(d3.interpolatePuBu(RowIndex / uniqueElementCount));
						break;
					case 'Purple_Red':
						steppedColorScale.push(d3.interpolatePuRd(RowIndex / uniqueElementCount));
						break;
					case 'Red_Purple':
						steppedColorScale.push(d3.interpolateRdPu(RowIndex / uniqueElementCount));
						break;
					case 'Yellow_Green_Blue':
						steppedColorScale.push(d3.interpolateYlGnBu(RowIndex / uniqueElementCount));
						break;
					case 'Yellow_Green':
						steppedColorScale.push(d3.interpolateYlGn(RowIndex / uniqueElementCount));
						break;
					case 'Yellow_Orange_Brown':
						steppedColorScale.push(d3.interpolateYlOrBr(RowIndex / uniqueElementCount));
						break;
					case 'Yellow_Orange_Red':
						steppedColorScale.push(d3.interpolateYlOrRd(RowIndex / uniqueElementCount));
						break;
					case 'Rainbow':
						steppedColorScale.push(d3.interpolateRainbow(RowIndex / uniqueElementCount));
						break;
					case 'Sinebow':
						steppedColorScale.push(d3.interpolateSinebow(RowIndex / uniqueElementCount));
						break;

					default:
						steppedColorScale.push(d3.interpolateRainbow(RowIndex / uniqueElementCount));
				}
			}

			return steppedColorScale;
		}

		// Filter the specified dimension to the specified value(s) for a target sheet in the dashboard
		function setFilterTo(filterSheetName, filterName, values) {
			//resetFilter(filterSheetName, filterName);
			var sheetToFilter = tableau.extensions.dashboardContent.dashboard.worksheets.find(function (sheet) { 
				return sheet.name === filterSheetName;
			});
			
			sheetToFilter.applyFilterAsync(filterName, values, tableau.FilterUpdateType.Replace);
		}
		
		function resetFilter(filterSheetName, arrDimensionList, arrTargetFilters) {
			var sheetToFilter = tableau.extensions.dashboardContent.dashboard.worksheets.find(function (sheet) { 
				return sheet.name === filterSheetName;
			});
			
			arrDimensionList.forEach(function(currentValue){
				if( arrTargetFilters.includes(currentValue) ) {
					sheetToFilter.clearFilterAsync(currentValue);	// Reset filters for sheetToFiler
				}
			});
		}

	})();		
</script>
</body>

<!-- Extensions Library (this will be hosted on a CDN eventually) -->
<!-- script src="../../lib/tableau-extensions-1.0.0.min.js"></script -->
<script>window.tableau=function(e){function t(n){if(r[n])return r[n].exports;var i=r[n]={i:n,l:!1,exports:{}};return e[n].call(i.exports,i,i.exports,t),i.l=!0,i.exports}var r={};return t.m=e,t.c=r,t.d=function(e,r,n){t.o(e,r)||Object.defineProperty(e,r,{configurable:!1,enumerable:!0,get:n})},t.n=function(e){var r=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(r,"a",r),r},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="/dist-extensions/",t(t.s=67)}([function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){for(var r in e)t.hasOwnProperty(r)||(t[r]=e[r])}(r(109))},function(e,t,r){"use strict";function n(e){for(var r in e)t.hasOwnProperty(r)||(t[r]=e[r])}Object.defineProperty(t,"__esModule",{value:!0}),r(54),r(110),n(r(113)),n(r(114)),n(r(115)),n(r(116)),n(r(117)),n(r(118)),n(r(121)),n(r(39)),t.INTERNAL_CONTRACT_VERSION={major:1,minor:4,fix:2},t.MESSAGING_VERSION={major:1,minor:0,fix:0}},function(e,t,r){var n=r(44)("wks"),i=r(26),o=r(3).Symbol,a="function"==typeof o;(e.exports=function(e){return n[e]||(n[e]=a&&o[e]||(a?o:i)("Symbol."+e))}).store=n},function(e,t){var r=e.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=r)},function(e,t,r){"use strict";var n=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(t,"__esModule",{value:!0});var i=function(e){function t(r,n){var i=e.call(this,r+": "+n)||this;return i._errorCode=r,Object.setPrototypeOf(i,t.prototype),i}return n(t,e),Object.defineProperty(t.prototype,"errorCode",{get:function(){return this._errorCode},enumerable:!0,configurable:!0}),t}(Error);t.TableauError=i},function(e,t,r){"use strict";function n(e){for(var r in e)t.hasOwnProperty(r)||(t[r]=e[r])}Object.defineProperty(t,"__esModule",{value:!0});var i=r(124);t.Dashboard=i.Dashboard;var o=r(40);t.EventListenerManager=o.EventListenerManager;var a=r(4);t.TableauError=a.TableauError;var s=r(125);t.VersionNumber=s.VersionNumber;var u=r(14);t.InternalToExternalEnumMappings=u.InternalToExternalEnumMappings;var c=r(58);t.TableauEvent=c.TableauEvent;var l=r(41);t.SingleEventManagerImpl=l.SingleEventManagerImpl;var p=r(126);t.DashboardImpl=p.DashboardImpl;var f=r(15);t.ServiceImplBase=f.ServiceImplBase;var d=r(8);t.ErrorHelpers=d.ErrorHelpers,n(r(137)),n(r(139)),n(r(7))},function(e,t){var r=e.exports={version:"2.5.7"};"number"==typeof __e&&(__e=r)},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(0),i=r(4),o=function(){function e(){this._services={}}return e.prototype.registerService=function(e){this._services[e.serviceName]=e},e.prototype.getService=function(e){if(!this._services.hasOwnProperty(e))throw new i.TableauError(n.ErrorCodes.InternalError,"Service not registered: "+e);return this._services[e]},e}(),a=function(){function e(){}return Object.defineProperty(e,"instance",{get:function(){if(window.__tableauApiServiceRegistry||e.setInstance(new o),!window.__tableauApiServiceRegistry)throw new i.TableauError(n.ErrorCodes.InternalError,"Service registry failed");return window.__tableauApiServiceRegistry},enumerable:!0,configurable:!0}),e.setInstance=function(e){window.__tableauApiServiceRegistry=e},e}();t.ApiServiceRegistry=a},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(0),i=r(42),o=r(4),a=function(){function e(){}return e.apiNotImplemented=function(e){return new o.TableauError(n.ErrorCodes.InternalError,e+" API not yet implemented.")},e.verifyInternalValue=function(e,t){if(null===e||void 0===e)throw new o.TableauError(n.ErrorCodes.InternalError,e+" is invalid value for: "+t)},e.verifyParameter=function(e,t){if(null===e||void 0===e)throw new o.TableauError(n.ErrorCodes.InvalidParameter,e+" is invalid value for paramter: "+t)},e.verifyStringParameter=function(e,t){if(null===e||void 0===e||""===e)throw new o.TableauError(n.ErrorCodes.InvalidParameter,e+" is invalid value for paramter: "+t)},e.verifyEnumValue=function(e,t){var r=!1;if(Object.keys(t).forEach(function(n){t[n]===e.toString()&&(r=!0)}),!r)throw new o.TableauError(n.ErrorCodes.InvalidParameter,e+" is invalid value for enum: "+t)},e.verifyRangeParamType=function(e,t){if(!e&&!t)throw new o.TableauError(n.ErrorCodes.InvalidParameter,"Unexpected invalid param value, at least one of min or max is required.");if(e&&!i.Param.isTypeNumber(e)&&!i.Param.isTypeDate(e))throw new o.TableauError(n.ErrorCodes.InvalidParameter,"Unexpected invalid param value, only Date and number are allowed for parameter min.");if(t&&!i.Param.isTypeNumber(t)&&!i.Param.isTypeDate(t))throw new o.TableauError(n.ErrorCodes.InvalidParameter,"Unexpected invalid param value, only Date and number are allowed for parameter max.");if(e&&t&&typeof e!=typeof t)throw new o.TableauError(n.ErrorCodes.InvalidParameter,"Unexpected invalid param value, parameters min and max should be of the same type.")},e}();t.ErrorHelpers=a},function(e,t,r){var n=r(10);e.exports=function(e){if(!n(e))throw TypeError(e+" is not an object!");return e}},function(e,t){e.exports=function(e){return"object"==typeof e?null!==e:"function"==typeof e}},function(e,t,r){var n=r(3),i=r(6),o=r(12),a=r(17),s=r(19),u=function(e,t,r){var c,l,p,f,d=e&u.F,y=e&u.G,g=e&u.S,h=e&u.P,m=e&u.B,v=y?n:g?n[t]||(n[t]={}):(n[t]||{}).prototype,b=y?i:i[t]||(i[t]={}),_=b.prototype||(b.prototype={});y&&(r=t);for(c in r)l=!d&&v&&void 0!==v[c],p=(l?v:r)[c],f=m&&l?s(p,n):h&&"function"==typeof p?s(Function.call,p):p,v&&a(v,c,p,e&u.U),b[c]!=p&&o(b,c,f),h&&_[c]!=p&&(_[c]=p)};n.core=i,u.F=1,u.G=2,u.S=4,u.P=8,u.B=16,u.W=32,u.U=64,u.R=128,e.exports=u},function(e,t,r){var n=r(21),i=r(45);e.exports=r(18)?function(e,t,r){return n.f(e,t,i(1,r))}:function(e,t,r){return e[t]=r,e}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){for(var r in e)t.hasOwnProperty(r)||(t[r]=e[r])}(r(0))},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(0),i=r(1),o=r(57),a=function(){function e(){}return e.extensionContext=new o.EnumConverter((s={},s[i.ExtensionContext.Desktop]=n.ExtensionContext.Desktop,s[i.ExtensionContext.Server]=n.ExtensionContext.Server,s)),e.extensionMode=new o.EnumConverter((u={},u[i.ExtensionMode.Authoring]=n.ExtensionMode.Authoring,u[i.ExtensionMode.Viewing]=n.ExtensionMode.Viewing,u)),e.columnType=new o.EnumConverter((c={},c[i.ColumnType.Continuous]=n.ColumnType.Continuous,c[i.ColumnType.Discrete]=n.ColumnType.Discrete,c)),e.fieldAggregationType=new o.EnumConverter((l={},l[i.FieldAggregationType.Attr]=n.FieldAggregationType.Attr,l[i.FieldAggregationType.Avg]=n.FieldAggregationType.Avg,l[i.FieldAggregationType.Count]=n.FieldAggregationType.Count,l[i.FieldAggregationType.Countd]=n.FieldAggregationType.Countd,l[i.FieldAggregationType.Day]=n.FieldAggregationType.Day,l[i.FieldAggregationType.End]=n.FieldAggregationType.End,l[i.FieldAggregationType.Hour]=n.FieldAggregationType.Hour,l[i.FieldAggregationType.InOut]=n.FieldAggregationType.InOut,l[i.FieldAggregationType.Kurtosis]=n.FieldAggregationType.Kurtosis,l[i.FieldAggregationType.Max]=n.FieldAggregationType.Max,l[i.FieldAggregationType.Mdy]=n.FieldAggregationType.Mdy,l[i.FieldAggregationType.Median]=n.FieldAggregationType.Median,l[i.FieldAggregationType.Min]=n.FieldAggregationType.Min,l[i.FieldAggregationType.Minute]=n.FieldAggregationType.Minute,l[i.FieldAggregationType.MonthYear]=n.FieldAggregationType.MonthYear,l[i.FieldAggregationType.None]=n.FieldAggregationType.None,l[i.FieldAggregationType.Qtr]=n.FieldAggregationType.Qtr,l[i.FieldAggregationType.Quart1]=n.FieldAggregationType.Quart1,l[i.FieldAggregationType.Quart3]=n.FieldAggregationType.Quart3,l[i.FieldAggregationType.Second]=n.FieldAggregationType.Second,l[i.FieldAggregationType.Skewness]=n.FieldAggregationType.Skewness,l[i.FieldAggregationType.Stdev]=n.FieldAggregationType.Stdev,l[i.FieldAggregationType.Stdevp]=n.FieldAggregationType.Stdevp,l[i.FieldAggregationType.Sum]=n.FieldAggregationType.Sum,l[i.FieldAggregationType.TruncDay]=n.FieldAggregationType.TruncDay,l[i.FieldAggregationType.TruncHour]=n.FieldAggregationType.TruncHour,l[i.FieldAggregationType.TruncMinute]=n.FieldAggregationType.TruncMinute,l[i.FieldAggregationType.TruncMonth]=n.FieldAggregationType.TruncMonth,l[i.FieldAggregationType.TruncQtr]=n.FieldAggregationType.TruncQtr,l[i.FieldAggregationType.TruncSecond]=n.FieldAggregationType.TruncSecond,l[i.FieldAggregationType.TruncWeek]=n.FieldAggregationType.TruncWeek,l[i.FieldAggregationType.TruncYear]=n.FieldAggregationType.TruncYear,l[i.FieldAggregationType.User]=n.FieldAggregationType.User,l[i.FieldAggregationType.Var]=n.FieldAggregationType.Var,l[i.FieldAggregationType.Varp]=n.FieldAggregationType.Varp,l[i.FieldAggregationType.Week]=n.FieldAggregationType.Week,l[i.FieldAggregationType.Weekday]=n.FieldAggregationType.Weekday,l[i.FieldAggregationType.Year]=n.FieldAggregationType.Year,l)),e.fieldRoleType=new o.EnumConverter((p={},p[i.FieldRoleType.Dimension]=n.FieldRoleType.Dimension,p[i.FieldRoleType.Measure]=n.FieldRoleType.Measure,p[i.FieldRoleType.Unknown]=n.FieldRoleType.Unknown,p)),e.sheetType=new o.EnumConverter((f={},f[i.SheetType.Dashboard]=n.SheetType.Dashboard,f[i.SheetType.Story]=n.SheetType.Story,f[i.SheetType.Worksheet]=n.SheetType.Worksheet,f)),e.dashboardObjectType=new o.EnumConverter((d={},d[i.DashboardObjectType.Extension]=n.DashboardObjectType.Extension,d[i.DashboardObjectType.Blank]=n.DashboardObjectType.Blank,d[i.DashboardObjectType.Image]=n.DashboardObjectType.Image,d[i.DashboardObjectType.Legend]=n.DashboardObjectType.Legend,d[i.DashboardObjectType.PageFilter]=n.DashboardObjectType.PageFilter,d[i.DashboardObjectType.ParameterControl]=n.DashboardObjectType.ParameterControl,d[i.DashboardObjectType.QuickFilter]=n.DashboardObjectType.QuickFilter,d[i.DashboardObjectType.Text]=n.DashboardObjectType.Text,d[i.DashboardObjectType.Title]=n.DashboardObjectType.Title,d[i.DashboardObjectType.WebPage]=n.DashboardObjectType.WebPage,d[i.DashboardObjectType.Worksheet]=n.DashboardObjectType.Worksheet,d)),e.dataType=new o.EnumConverter((y={},y[i.DataType.Bool]=n.DataType.Bool,y[i.DataType.Date]=n.DataType.Date,y[i.DataType.DateTime]=n.DataType.DateTime,y[i.DataType.Float]=n.DataType.Float,y[i.DataType.Int]=n.DataType.Int,y[i.DataType.String]=n.DataType.String,y)),e.filterUpdateType=new o.EnumConverter((g={},g[i.FilterUpdateType.Add]=n.FilterUpdateType.Add,g[i.FilterUpdateType.All]=n.FilterUpdateType.All,g[i.FilterUpdateType.Remove]=n.FilterUpdateType.Remove,g[i.FilterUpdateType.Replace]=n.FilterUpdateType.Replace,g)),e.allowableValues=new o.EnumConverter((h={},h[i.DomainRestrictionType.All]=n.ParameterValueType.All,h[i.DomainRestrictionType.List]=n.ParameterValueType.List,h[i.DomainRestrictionType.Range]=n.ParameterValueType.Range,h)),e.dateStepPeriod=new o.EnumConverter((m={},m[i.DateStepPeriod.Years]=n.PeriodType.Years,m[i.DateStepPeriod.Quarters]=n.PeriodType.Quarters,m[i.DateStepPeriod.Months]=n.PeriodType.Months,m[i.DateStepPeriod.Weeks]=n.PeriodType.Weeks,m[i.DateStepPeriod.Days]=n.PeriodType.Days,m[i.DateStepPeriod.Hours]=n.PeriodType.Hours,m[i.DateStepPeriod.Minutes]=n.PeriodType.Minutes,m[i.DateStepPeriod.Seconds]=n.PeriodType.Seconds,m)),e.dateRangeType=new o.EnumConverter((v={},v[i.DateRangeType.Current]=n.DateRangeType.Current,v[i.DateRangeType.Last]=n.DateRangeType.Last,v[i.DateRangeType.LastN]=n.DateRangeType.LastN,v[i.DateRangeType.Next]=n.DateRangeType.Next,v[i.DateRangeType.NextN]=n.DateRangeType.NextN,v[i.DateRangeType.ToDate]=n.DateRangeType.ToDate,v)),e.errorCode=new o.EnumConverter((b={},b[i.ErrorCodes.INITIALIZATION_ERROR]=n.ErrorCodes.InternalError,b[i.ErrorCodes.INTERNAL_ERROR]=n.ErrorCodes.InternalError,b[i.ErrorCodes.MISSING_ENUM_MAPPING]=n.ErrorCodes.InternalError,b[i.ErrorCodes.MISSING_PARAMETER]=n.ErrorCodes.InternalError,b[i.ErrorCodes.PERMISSION_DENIED]=n.ErrorCodes.InternalError,b[i.ErrorCodes.PRES_MODEL_PARSING_ERROR]=n.ErrorCodes.InternalError,b[i.ErrorCodes.UNKNOWN_VERB_ID]=n.ErrorCodes.InternalError,b[i.ErrorCodes.VERSION_NOT_CONFIGURED]=n.ErrorCodes.APINotInitialized,b)),e.filterType=new o.EnumConverter((_={},_[i.FilterType.Categorical]=n.FilterType.Categorical,_[i.FilterType.Range]=n.FilterType.Range,_[i.FilterType.RelativeDate]=n.FilterType.RelativeDate,_[i.FilterType.Hierarchical]=n.FilterType.Hierarchical,_)),e}();t.InternalToExternalEnumMappings=a;var s,u,c,l,p,f,d,y,g,h,m,v,b,_},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(14),i=r(4),o=function(){function e(e){this._dispatcher=e}return e.prototype.execute=function(e,t){return this._dispatcher.execute(e,t).catch(function(e){var t=e,r=n.InternalToExternalEnumMappings.errorCode.convert(t.errorCode);throw new i.TableauError(r,t.message)})},e}();t.ServiceImplBase=o},function(e,t){var r={}.toString;e.exports=function(e){return r.call(e).slice(8,-1)}},function(e,t,r){var n=r(3),i=r(12),o=r(22),a=r(26)("src"),s=Function.toString,u=(""+s).split("toString");r(6).inspectSource=function(e){return s.call(e)},(e.exports=function(e,t,r,s){var c="function"==typeof r;c&&(o(r,"name")||i(r,"name",t)),e[t]!==r&&(c&&(o(r,a)||i(r,a,e[t]?""+e[t]:u.join(String(t)))),e===n?e[t]=r:s?e[t]?e[t]=r:i(e,t,r):(delete e[t],i(e,t,r)))})(Function.prototype,"toString",function(){return"function"==typeof this&&this[a]||s.call(this)})},function(e,t,r){e.exports=!r(27)(function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a})},function(e,t,r){var n=r(23);e.exports=function(e,t,r){if(n(e),void 0===t)return e;switch(r){case 1:return function(r){return e.call(t,r)};case 2:return function(r,n){return e.call(t,r,n)};case 3:return function(r,n,i){return e.call(t,r,n,i)}}return function(){return e.apply(t,arguments)}}},function(e,t){e.exports={}},function(e,t,r){var n=r(9),i=r(70),o=r(71),a=Object.defineProperty;t.f=r(18)?Object.defineProperty:function(e,t,r){if(n(e),t=o(t,!0),n(r),i)try{return a(e,t,r)}catch(e){}if("get"in r||"set"in r)throw TypeError("Accessors not supported!");return"value"in r&&(e[t]=r.value),e}},function(e,t){var r={}.hasOwnProperty;e.exports=function(e,t){return r.call(e,t)}},function(e,t){e.exports=function(e){if("function"!=typeof e)throw TypeError(e+" is not a function!");return e}},function(e,t,r){var n=r(16),i=r(2)("toStringTag"),o="Arguments"==n(function(){return arguments}()),a=function(e,t){try{return e[t]}catch(e){}};e.exports=function(e){var t,r,s;return void 0===e?"Undefined":null===e?"Null":"string"==typeof(r=a(t=Object(e),i))?r:o?n(t):"Object"==(s=n(t))&&"function"==typeof t.callee?"Arguments":s}},function(e,t){e.exports=!1},function(e,t){var r=0,n=Math.random();e.exports=function(e){return"Symbol(".concat(void 0===e?"":e,")_",(++r+n).toString(36))}},function(e,t){e.exports=function(e){try{return!!e()}catch(e){return!0}}},function(e,t,r){var n=r(10),i=r(3).document,o=n(i)&&n(i.createElement);e.exports=function(e){return o?i.createElement(e):{}}},function(e,t){var r=Math.ceil,n=Math.floor;e.exports=function(e){return isNaN(e=+e)?0:(e>0?n:r)(e)}},function(e,t){e.exports=function(e){if(void 0==e)throw TypeError("Can't call method on  "+e);return e}},function(e,t,r){var n=r(77),i=r(47);e.exports=Object.keys||function(e){return n(e,i)}},function(e,t,r){var n=r(33),i=r(30);e.exports=function(e){return n(i(e))}},function(e,t,r){var n=r(16);e.exports=Object("z").propertyIsEnumerable(0)?Object:function(e){return"String"==n(e)?e.split(""):Object(e)}},function(e,t,r){var n=r(29),i=Math.min;e.exports=function(e){return e>0?i(n(e),9007199254740991):0}},function(e,t,r){var n=r(44)("keys"),i=r(26);e.exports=function(e){return n[e]||(n[e]=i(e))}},function(e,t,r){var n=r(21).f,i=r(22),o=r(2)("toStringTag");e.exports=function(e,t,r){e&&!i(e=r?e:e.prototype,o)&&n(e,o,{configurable:!0,value:t})}},function(e,t,r){var n=r(30);e.exports=function(e){return Object(n(e))}},function(e,t,r){"use strict";function n(e){var t,r;this.promise=new e(function(e,n){if(void 0!==t||void 0!==r)throw TypeError("Bad Promise constructor");t=e,r=n}),this.resolve=i(t),this.reject=i(r)}var i=r(23);e.exports.f=function(e){return new n(e)}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});!function(e){e.Initialize="initialize",e.Notification="notification",e.Command="command",e.CommandResponse="command-response"}(t.MessageType||(t.MessageType={}))},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(0),i=r(4),o=function(){function e(){this._eventListenerManagers={}}return e.prototype.addEventListener=function(e,t){if(!this._eventListenerManagers.hasOwnProperty(e))throw new i.TableauError(n.ErrorCodes.UnsupportedEventName,"Cannot add event, unsupported event type: "+e);return this._eventListenerManagers[e].addEventListener(t)},e.prototype.removeEventListener=function(e,t){if(!this._eventListenerManagers.hasOwnProperty(e))throw new i.TableauError(n.ErrorCodes.UnsupportedEventName,"Cannot remove event, unsupported event type: "+e);return this._eventListenerManagers[e].removeEventListener(t)},e.prototype.addNewEventType=function(e){this._eventListenerManagers[e.eventType]=e},e}();t.EventListenerManager=o},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e){this._eventType=e,this._handlers=[]}return Object.defineProperty(e.prototype,"eventType",{get:function(){return this._eventType},enumerable:!0,configurable:!0}),e.prototype.addEventListener=function(e){var t=this;return this._handlers.push(e),function(){return t.removeEventListener(e)}},e.prototype.removeEventListener=function(e){var t=this._handlers.length;return this._handlers=this._handlers.filter(function(t){return t!==e}),t>this._handlers.length},e.prototype.triggerEvent=function(e){for(var t=0,r=this._handlers;t<r.length;t++){var n=r[t];try{n(e())}catch(e){continue}}},e}();t.SingleEventManagerImpl=n},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(0),i=r(4),o=function(){function e(){}return e.serializeDateForPlatform=function(e){return e.getUTCFullYear()+"-"+(e.getUTCMonth()+1)+"-"+e.getUTCDate()+" "+e.getUTCHours()+":"+e.getUTCMinutes()+":"+e.getUTCSeconds()},e.serializeBooleanForPlatform=function(e){return e?"true":"false"},e.serializeNumberForPlatform=function(e){return e.toString(10)},e.isTypeNumber=function(e){return"number"==typeof e||e instanceof Number},e.isTypeDate=function(e){return e instanceof Date},e.isTypeString=function(e){return"string"==typeof e||e instanceof String},e.isTypeBool=function(e){return"boolean"==typeof e||e instanceof Boolean},e.serializeParamterValue=function(t){if(e.isTypeNumber(t))return e.serializeNumberForPlatform(t);if(e.isTypeDate(t))return e.serializeDateForPlatform(t);if(e.isTypeBool(t))return e.serializeBooleanForPlatform(t);if(e.isTypeString(t))return t;throw new i.TableauError(n.ErrorCodes.InternalError,"Unexpected invalid value for: "+t)},e}();t.Param=o},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t,r,n,i,o){this._data=e,this._columns=t,this._totalRowCount=r,this._isTotalRowCountLimited=n,this._isSummaryData=i,this._marksInfo=o,this._name=i?"Summary Data Table":"Underlying Data Table"}return Object.defineProperty(e.prototype,"name",{get:function(){return this._name},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"data",{get:function(){return this._data},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"columns",{get:function(){return this._columns},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"marksInfo",{get:function(){return this._marksInfo},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"totalRowCount",{get:function(){return this._totalRowCount},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isTotalRowCountLimited",{get:function(){return this._isTotalRowCountLimited},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isSummaryData",{get:function(){return this._isSummaryData},enumerable:!0,configurable:!0}),e}();t.DataTable=n;var i=function(){function e(e,t,r){this._type=e,this._color=t,this._tupleId=r}return Object.defineProperty(e.prototype,"type",{get:function(){return this._type},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"color",{get:function(){return this._color},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"tupleId",{get:function(){return this._tupleId},enumerable:!0,configurable:!0}),e}();t.MarkInfo=i;var o=function(){function e(e,t,r,n){this._fieldName=e,this._dataType=t,this._isReferenced=r,this._index=n}return Object.defineProperty(e.prototype,"fieldName",{get:function(){return this._fieldName},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"dataType",{get:function(){return this._dataType},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isReferenced",{get:function(){return this._isReferenced},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"index",{get:function(){return this._index},enumerable:!0,configurable:!0}),e}();t.Column=o;var a=function(){function e(e,t){this._value=e,this._formattedValue=t}return Object.defineProperty(e.prototype,"value",{get:function(){return this._value},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"formattedValue",{get:function(){return this._formattedValue},enumerable:!0,configurable:!0}),e}();t.DataValue=a},function(e,t,r){var n=r(6),i=r(3),o=i["__core-js_shared__"]||(i["__core-js_shared__"]={});(e.exports=function(e,t){return o[e]||(o[e]=void 0!==t?t:{})})("versions",[]).push({version:n.version,mode:r(25)?"pure":"global",copyright:"© 2018 Denis Pushkarev (zloirock.ru)"})},function(e,t){e.exports=function(e,t){return{enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:t}}},function(e,t,r){"use strict";var n=r(25),i=r(11),o=r(17),a=r(12),s=r(20),u=r(74),c=r(36),l=r(80),p=r(2)("iterator"),f=!([].keys&&"next"in[].keys()),d=function(){return this};e.exports=function(e,t,r,y,g,h,m){u(r,t,y);var v,b,_,T=function(e){if(!f&&e in w)return w[e];switch(e){case"keys":case"values":return function(){return new r(this,e)}}return function(){return new r(this,e)}},P=t+" Iterator",I="values"==g,S=!1,w=e.prototype,O=w[p]||w["@@iterator"]||g&&w[g],E=O||T(g),D=g?I?T("entries"):E:void 0,A="Array"==t?w.entries||O:O;if(A&&(_=l(A.call(new e)))!==Object.prototype&&_.next&&(c(_,P,!0),n||"function"==typeof _[p]||a(_,p,d)),I&&O&&"values"!==O.name&&(S=!0,E=function(){return O.call(this)}),n&&!m||!f&&!S&&w[p]||a(w,p,E),s[t]=E,s[P]=d,g)if(v={values:I?E:T("values"),keys:h?E:T("keys"),entries:D},m)for(b in v)b in w||o(w,b,v[b]);else i(i.P+i.F*(f||S),t,v);return v}},function(e,t){e.exports="constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf".split(",")},function(e,t,r){var n=r(3).document;e.exports=n&&n.documentElement},function(e,t,r){var n=r(2)("unscopables"),i=Array.prototype;void 0==i[n]&&r(12)(i,n,{}),e.exports=function(e){i[n][e]=!0}},function(e,t,r){var n=r(9),i=r(23),o=r(2)("species");e.exports=function(e,t){var r,a=n(e).constructor;return void 0===a||void 0==(r=n(a)[o])?t:i(r)}},function(e,t,r){var n,i,o,a=r(19),s=r(90),u=r(48),c=r(28),l=r(3),p=l.process,f=l.setImmediate,d=l.clearImmediate,y=l.MessageChannel,g=l.Dispatch,h=0,m={},v=function(){var e=+this;if(m.hasOwnProperty(e)){var t=m[e];delete m[e],t()}},b=function(e){v.call(e.data)};f&&d||(f=function(e){for(var t=[],r=1;arguments.length>r;)t.push(arguments[r++]);return m[++h]=function(){s("function"==typeof e?e:Function(e),t)},n(h),h},d=function(e){delete m[e]},"process"==r(16)(p)?n=function(e){p.nextTick(a(v,e,1))}:g&&g.now?n=function(e){g.now(a(v,e,1))}:y?(i=new y,o=i.port2,i.port1.onmessage=b,n=a(o.postMessage,o,1)):l.addEventListener&&"function"==typeof postMessage&&!l.importScripts?(n=function(e){l.postMessage(e+"","*")},l.addEventListener("message",b,!1)):n="onreadystatechange"in c("script")?function(e){u.appendChild(c("script")).onreadystatechange=function(){u.removeChild(this),v.call(e)}}:function(e){setTimeout(a(v,e,1),0)}),e.exports={set:f,clear:d}},function(e,t){e.exports=function(e){try{return{e:!1,v:e()}}catch(e){return{e:!0,v:e}}}},function(e,t,r){var n=r(9),i=r(10),o=r(38);e.exports=function(e,t){if(n(e),i(t)&&t.constructor===e)return t;var r=o.f(e);return(0,r.resolve)(t),r.promise}},function(e,t,r){r(104),e.exports=r(6).Object.assign},function(e,t){!function(){function t(e){for(var t="",r=0;r<e;r++)t+=(65536*(1+Math.random())|0).toString(16).substring(1);return t}function r(e){if(!e)throw new TypeError("Invalid argument; `value` has no value.");this.value=r.EMPTY,e&&e instanceof r?this.value=e.toString():e&&"[object String]"===Object.prototype.toString.call(e)&&r.isGuid(e)&&(this.value=e),this.equals=function(e){return r.isGuid(e)&&this.value==e},this.isEmpty=function(){return this.value===r.EMPTY},this.toString=function(){return this.value},this.toJSON=function(){return this.value}}var n=new RegExp("^[a-z0-9]{8}-[a-z0-9]{4}-[a-z0-9]{4}-[a-z0-9]{4}-[a-z0-9]{12}$","i");r.EMPTY="00000000-0000-0000-0000-000000000000",r.isGuid=function(e){return e&&(e instanceof r||n.test(e.toString()))},r.create=function(){return new r([t(2),t(1),t(1),t(1),t(3)].join("-"))},r.raw=function(){return[t(2),t(1),t(1),t(1),t(3)].join("-")},void 0!==e&&e.exports?e.exports=r:"undefined"!=typeof window&&(window.Guid=r)}()},function(e,t,r){"use strict";var n=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(t,"__esModule",{value:!0});var i=r(40),o=function(e){function t(t){var r=e.call(this)||this;return r._sheetImpl=t,r}return n(t,e),Object.defineProperty(t.prototype,"name",{get:function(){return this._sheetImpl.name},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"sheetType",{get:function(){return this._sheetImpl.sheetType},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"size",{get:function(){return this._sheetImpl.size},enumerable:!0,configurable:!0}),t.prototype.findParameterAsync=function(e){return this._sheetImpl.findParameterAsync(e,this)},t.prototype.getParametersAsync=function(){return this._sheetImpl.getParametersAsync(this)},t}(i.EventListenerManager);t.Sheet=o},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(0),i=r(4),o=function(){function e(e,t){this._mappings=e,this._defaultVal=t}return e.prototype.convert=function(e,t){if(this._mappings.hasOwnProperty(e))return this._mappings[e];if(void 0!==this._defaultVal&&!t)return this._defaultVal;throw new i.TableauError(n.ErrorCodes.InternalError,"Enum Mapping not found for: "+e)},e}();t.EnumConverter=o},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e){this._type=e}return Object.defineProperty(e.prototype,"type",{get:function(){return this._type},enumerable:!0,configurable:!0}),e}();t.TableauEvent=n},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(7),i=r(8),o=function(){function e(e){this._sheetInfoImpl=e}return Object.defineProperty(e.prototype,"name",{get:function(){return this._sheetInfoImpl.name},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"sheetType",{get:function(){return this._sheetInfoImpl.sheetType},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"sheetPath",{get:function(){return this._sheetInfoImpl.sheetPath},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"size",{get:function(){return this._sheetInfoImpl.sheetSize},enumerable:!0,configurable:!0}),e.prototype.findParameterAsync=function(e,t){return i.ErrorHelpers.verifyParameter(e,"parameterName"),i.ErrorHelpers.verifyParameter(t,"sheet"),n.ApiServiceRegistry.instance.getService("parameters-service").findParameterByNameAsync(e,t)},e.prototype.getParametersAsync=function(e){return i.ErrorHelpers.verifyParameter(e,"sheet"),n.ApiServiceRegistry.instance.getService("parameters-service").getParametersForSheetAsync(this.sheetPath,e)},e}();t.SheetImpl=o},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e){this._dataSourceImpl=e}return Object.defineProperty(e.prototype,"name",{get:function(){return this._dataSourceImpl.name},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"id",{get:function(){return this._dataSourceImpl.id},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"fields",{get:function(){return this._dataSourceImpl.fields},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"extractUpdateTime",{get:function(){return this._dataSourceImpl.extractUpdateTime},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isExtract",{get:function(){return this._dataSourceImpl.isExtract},enumerable:!0,configurable:!0}),e.prototype.refreshAsync=function(){return this._dataSourceImpl.refreshAsync()},e.prototype.getActiveTablesAsync=function(){return this._dataSourceImpl.getActiveTablesAsync()},e.prototype.getConnectionSummariesAsync=function(){return this._dataSourceImpl.getConnectionSummariesAsync()},e.prototype.getUnderlyingDataAsync=function(e){return this._dataSourceImpl.getUnderlyingDataAsync(e)},e}();t.DataSource=n},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(62),i=r(133),o=r(63),a=r(134),s=r(7),u=r(8),c=function(){function e(e){var t=this;this._dataSourceInfo=e,this._fields=e.fields.map(function(e){var r=new n.FieldImpl(e,t);return new o.Field(r)})}return Object.defineProperty(e.prototype,"name",{get:function(){return this._dataSourceInfo.name},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"id",{get:function(){return this._dataSourceInfo.id},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"extractUpdateTime",{get:function(){return this._dataSourceInfo.extractUpdateTime},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"fields",{get:function(){return this._fields},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isExtract",{get:function(){return this._dataSourceInfo.isExtract},enumerable:!0,configurable:!0}),e.prototype.refreshAsync=function(){return s.ApiServiceRegistry.instance.getService("data-source-service").refreshAsync(this._dataSourceInfo.id)},e.prototype.getConnectionSummariesAsync=function(){return s.ApiServiceRegistry.instance.getService("data-source-service").getConnectionSummariesAsync(this._dataSourceInfo.id).then(function(e){return e.map(function(e){return new i.ConnectionSummary(e)})})},e.prototype.getActiveTablesAsync=function(){return s.ApiServiceRegistry.instance.getService("data-source-service").getActiveTablesAsync(this._dataSourceInfo.id).then(function(e){return e.map(function(e){return new a.TableSummary(e)})})},e.prototype.getUnderlyingDataAsync=function(e){var t=s.ApiServiceRegistry.instance.getService("get-data-service");return e=e||{},t.getDataSourceDataAsync(this.id,!!e.ignoreAliases,e.maxRows||0,e.columnsToInclude||[])},e.prototype.initializeWithPublicInterfaces=function(e){u.ErrorHelpers.verifyInternalValue(e,"dataSource"),this._fields=this._dataSourceInfo.fields.map(function(t){var r=new n.FieldImpl(t,e);return new o.Field(r)})},e}();t.DataSourceImpl=c},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(14),i=function(){function e(e,t){this._fieldInfo=e,this._parentDataSource=t}return Object.defineProperty(e.prototype,"name",{get:function(){return this._fieldInfo.name},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"id",{get:function(){return this._fieldInfo.id},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"description",{get:function(){return this._fieldInfo.description},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"aggregation",{get:function(){return n.InternalToExternalEnumMappings.fieldAggregationType.convert(this._fieldInfo.aggregation)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"dataSource",{get:function(){return this._parentDataSource},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"role",{get:function(){return n.InternalToExternalEnumMappings.fieldRoleType.convert(this._fieldInfo.role)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isHidden",{get:function(){return this._fieldInfo.isHidden},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isGenerated",{get:function(){return this._fieldInfo.isGenerated},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isCalculatedField",{get:function(){return this._fieldInfo.isCalculatedField},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isCombinedField",{get:function(){return this._fieldInfo.isCombinedField},enumerable:!0,configurable:!0}),e}();t.FieldImpl=i},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(8),i=function(){function e(e){this._fieldImpl=e}return Object.defineProperty(e.prototype,"name",{get:function(){return this._fieldImpl.name},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"id",{get:function(){return this._fieldImpl.id},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"description",{get:function(){return this._fieldImpl.description},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"aggregation",{get:function(){return this._fieldImpl.aggregation},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"dataSource",{get:function(){return this._fieldImpl.dataSource},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"role",{get:function(){return this._fieldImpl.role},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isHidden",{get:function(){return this._fieldImpl.isHidden},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isGenerated",{get:function(){return this._fieldImpl.isGenerated},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isCalculatedField",{get:function(){return this._fieldImpl.isCalculatedField},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"columnType",{get:function(){throw n.ErrorHelpers.apiNotImplemented("Field.columnType")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isCombinedField",{get:function(){return this._fieldImpl.isCombinedField},enumerable:!0,configurable:!0}),e}();t.Field=i},function(e,t,r){"use strict";var n=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(t,"__esModule",{value:!0});var i=r(65),o=function(e){function t(t,r){var n=e.call(this,t,r)||this;return n._worksheet=r,n}return n(t,e),Object.defineProperty(t.prototype,"worksheet",{get:function(){return this._worksheet},enumerable:!0,configurable:!0}),t}(i.TableauSheetEvent);t.TableauWorksheetEvent=o},function(e,t,r){"use strict";var n=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(t,"__esModule",{value:!0});var i=r(58),o=function(e){function t(t,r){var n=e.call(this,t)||this;return n._sheet=r,n}return n(t,e),Object.defineProperty(t.prototype,"sheet",{get:function(){return this._sheet},enumerable:!0,configurable:!0}),t}(i.TableauEvent);t.TableauSheetEvent=o},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});!function(e){e.Summary="summary",e.Underlying="underlying"}(t.GetDataType||(t.GetDataType={}))},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),r(68),r(98),r(54);var n=r(108),i=r(162);r(5).VersionNumber.SetVersionNumber("1.0.0");var o=new n.ExtensionsImpl;t.extensions=new i.Extensions(o);var a=r(13);t.ExtensionContext=a.ExtensionContext,t.ExtensionMode=a.ExtensionMode,t.AnalyticsObjectType=a.AnalyticsObjectType,t.ColumnType=a.ColumnType,t.DashboardObjectType=a.DashboardObjectType,t.DataType=a.DataType,t.DateRangeType=a.DateRangeType,t.EncodingType=a.EncodingType,t.ErrorCodes=a.ErrorCodes,t.FieldAggregationType=a.FieldAggregationType,t.FieldRoleType=a.FieldRoleType,t.FilterDomainType=a.FilterDomainType,t.FilterType=a.FilterType,t.FilterUpdateType=a.FilterUpdateType,t.FilterNullOption=a.FilterNullOption,t.MarkType=a.MarkType,t.ParameterValueType=a.ParameterValueType,t.PeriodType=a.PeriodType,t.QuickTableCalcType=a.QuickTableCalcType,t.SelectionUpdateType=a.SelectionUpdateType,t.SheetType=a.SheetType,t.SortDirection=a.SortDirection,t.TableauEventType=a.TableauEventType,t.TrendLineModelType=a.TrendLineModelType},function(e,t,r){r(69),r(72),r(81),r(84),r(96),r(97),e.exports=r(6).Promise},function(e,t,r){"use strict";var n=r(24),i={};i[r(2)("toStringTag")]="z",i+""!="[object z]"&&r(17)(Object.prototype,"toString",function(){return"[object "+n(this)+"]"},!0)},function(e,t,r){e.exports=!r(18)&&!r(27)(function(){return 7!=Object.defineProperty(r(28)("div"),"a",{get:function(){return 7}}).a})},function(e,t,r){var n=r(10);e.exports=function(e,t){if(!n(e))return e;var r,i;if(t&&"function"==typeof(r=e.toString)&&!n(i=r.call(e)))return i;if("function"==typeof(r=e.valueOf)&&!n(i=r.call(e)))return i;if(!t&&"function"==typeof(r=e.toString)&&!n(i=r.call(e)))return i;throw TypeError("Can't convert object to primitive value")}},function(e,t,r){"use strict";var n=r(73)(!0);r(46)(String,"String",function(e){this._t=String(e),this._i=0},function(){var e,t=this._t,r=this._i;return r>=t.length?{value:void 0,done:!0}:(e=n(t,r),this._i+=e.length,{value:e,done:!1})})},function(e,t,r){var n=r(29),i=r(30);e.exports=function(e){return function(t,r){var o,a,s=String(i(t)),u=n(r),c=s.length;return u<0||u>=c?e?"":void 0:(o=s.charCodeAt(u),o<55296||o>56319||u+1===c||(a=s.charCodeAt(u+1))<56320||a>57343?e?s.charAt(u):o:e?s.slice(u,u+2):a-56320+(o-55296<<10)+65536)}}},function(e,t,r){"use strict";var n=r(75),i=r(45),o=r(36),a={};r(12)(a,r(2)("iterator"),function(){return this}),e.exports=function(e,t,r){e.prototype=n(a,{next:i(1,r)}),o(e,t+" Iterator")}},function(e,t,r){var n=r(9),i=r(76),o=r(47),a=r(35)("IE_PROTO"),s=function(){},u=function(){var e,t=r(28)("iframe"),n=o.length;for(t.style.display="none",r(48).appendChild(t),t.src="javascript:",e=t.contentWindow.document,e.open(),e.write("<script>document.F=Object<\/script>"),e.close(),u=e.F;n--;)delete u.prototype[o[n]];return u()};e.exports=Object.create||function(e,t){var r;return null!==e?(s.prototype=n(e),r=new s,s.prototype=null,r[a]=e):r=u(),void 0===t?r:i(r,t)}},function(e,t,r){var n=r(21),i=r(9),o=r(31);e.exports=r(18)?Object.defineProperties:function(e,t){i(e);for(var r,a=o(t),s=a.length,u=0;s>u;)n.f(e,r=a[u++],t[r]);return e}},function(e,t,r){var n=r(22),i=r(32),o=r(78)(!1),a=r(35)("IE_PROTO");e.exports=function(e,t){var r,s=i(e),u=0,c=[];for(r in s)r!=a&&n(s,r)&&c.push(r);for(;t.length>u;)n(s,r=t[u++])&&(~o(c,r)||c.push(r));return c}},function(e,t,r){var n=r(32),i=r(34),o=r(79);e.exports=function(e){return function(t,r,a){var s,u=n(t),c=i(u.length),l=o(a,c);if(e&&r!=r){for(;c>l;)if((s=u[l++])!=s)return!0}else for(;c>l;l++)if((e||l in u)&&u[l]===r)return e||l||0;return!e&&-1}}},function(e,t,r){var n=r(29),i=Math.max,o=Math.min;e.exports=function(e,t){return e=n(e),e<0?i(e+t,0):o(e,t)}},function(e,t,r){var n=r(22),i=r(37),o=r(35)("IE_PROTO"),a=Object.prototype;e.exports=Object.getPrototypeOf||function(e){return e=i(e),n(e,o)?e[o]:"function"==typeof e.constructor&&e instanceof e.constructor?e.constructor.prototype:e instanceof Object?a:null}},function(e,t,r){for(var n=r(82),i=r(31),o=r(17),a=r(3),s=r(12),u=r(20),c=r(2),l=c("iterator"),p=c("toStringTag"),f=u.Array,d={CSSRuleList:!0,CSSStyleDeclaration:!1,CSSValueList:!1,ClientRectList:!1,DOMRectList:!1,DOMStringList:!1,DOMTokenList:!0,DataTransferItemList:!1,FileList:!1,HTMLAllCollection:!1,HTMLCollection:!1,HTMLFormElement:!1,HTMLSelectElement:!1,MediaList:!0,MimeTypeArray:!1,NamedNodeMap:!1,NodeList:!0,PaintRequestList:!1,Plugin:!1,PluginArray:!1,SVGLengthList:!1,SVGNumberList:!1,SVGPathSegList:!1,SVGPointList:!1,SVGStringList:!1,SVGTransformList:!1,SourceBufferList:!1,StyleSheetList:!0,TextTrackCueList:!1,TextTrackList:!1,TouchList:!1},y=i(d),g=0;g<y.length;g++){var h,m=y[g],v=d[m],b=a[m],_=b&&b.prototype;if(_&&(_[l]||s(_,l,f),_[p]||s(_,p,m),u[m]=f,v))for(h in n)_[h]||o(_,h,n[h],!0)}},function(e,t,r){"use strict";var n=r(49),i=r(83),o=r(20),a=r(32);e.exports=r(46)(Array,"Array",function(e,t){this._t=a(e),this._i=0,this._k=t},function(){var e=this._t,t=this._k,r=this._i++;return!e||r>=e.length?(this._t=void 0,i(1)):"keys"==t?i(0,r):"values"==t?i(0,e[r]):i(0,[r,e[r]])},"values"),o.Arguments=o.Array,n("keys"),n("values"),n("entries")},function(e,t){e.exports=function(e,t){return{value:t,done:!!e}}},function(e,t,r){"use strict";var n,i,o,a,s=r(25),u=r(3),c=r(19),l=r(24),p=r(11),f=r(10),d=r(23),y=r(85),g=r(86),h=r(50),m=r(51).set,v=r(91)(),b=r(38),_=r(52),T=r(92),P=r(53),I=u.TypeError,S=u.process,w=S&&S.versions,O=w&&w.v8||"",E=u.Promise,D="process"==l(S),A=function(){},M=i=b.f,x=!!function(){try{var e=E.resolve(1),t=(e.constructor={})[r(2)("species")]=function(e){e(A,A)};return(D||"function"==typeof PromiseRejectionEvent)&&e.then(A)instanceof t&&0!==O.indexOf("6.6")&&-1===T.indexOf("Chrome/66")}catch(e){}}(),j=function(e){var t;return!(!f(e)||"function"!=typeof(t=e.then))&&t},F=function(e,t){if(!e._n){e._n=!0;var r=e._c;v(function(){for(var n=e._v,i=1==e._s,o=0;r.length>o;)!function(t){var r,o,a,s=i?t.ok:t.fail,u=t.resolve,c=t.reject,l=t.domain;try{s?(i||(2==e._h&&N(e),e._h=1),!0===s?r=n:(l&&l.enter(),r=s(n),l&&(l.exit(),a=!0)),r===t.promise?c(I("Promise-chain cycle")):(o=j(r))?o.call(r,u,c):u(r)):c(n)}catch(e){l&&!a&&l.exit(),c(e)}}(r[o++]);e._c=[],e._n=!1,t&&!e._h&&C(e)})}},C=function(e){m.call(u,function(){var t,r,n,i=e._v,o=R(e);if(o&&(t=_(function(){D?S.emit("unhandledRejection",i,e):(r=u.onunhandledrejection)?r({promise:e,reason:i}):(n=u.console)&&n.error&&n.error("Unhandled promise rejection",i)}),e._h=D||R(e)?2:1),e._a=void 0,o&&t.e)throw t.v})},R=function(e){return 1!==e._h&&0===(e._a||e._c).length},N=function(e){m.call(u,function(){var t;D?S.emit("rejectionHandled",e):(t=u.onrejectionhandled)&&t({promise:e,reason:e._v})})},k=function(e){var t=this;t._d||(t._d=!0,t=t._w||t,t._v=e,t._s=2,t._a||(t._a=t._c.slice()),F(t,!0))},V=function(e){var t,r=this;if(!r._d){r._d=!0,r=r._w||r;try{if(r===e)throw I("Promise can't be resolved itself");(t=j(e))?v(function(){var n={_w:r,_d:!1};try{t.call(e,c(V,n,1),c(k,n,1))}catch(e){k.call(n,e)}}):(r._v=e,r._s=1,F(r,!1))}catch(e){k.call({_w:r,_d:!1},e)}}};x||(E=function(e){y(this,E,"Promise","_h"),d(e),n.call(this);try{e(c(V,this,1),c(k,this,1))}catch(e){k.call(this,e)}},n=function(e){this._c=[],this._a=void 0,this._s=0,this._d=!1,this._v=void 0,this._h=0,this._n=!1},n.prototype=r(93)(E.prototype,{then:function(e,t){var r=M(h(this,E));return r.ok="function"!=typeof e||e,r.fail="function"==typeof t&&t,r.domain=D?S.domain:void 0,this._c.push(r),this._a&&this._a.push(r),this._s&&F(this,!1),r.promise},catch:function(e){return this.then(void 0,e)}}),o=function(){var e=new n;this.promise=e,this.resolve=c(V,e,1),this.reject=c(k,e,1)},b.f=M=function(e){return e===E||e===a?new o(e):i(e)}),p(p.G+p.W+p.F*!x,{Promise:E}),r(36)(E,"Promise"),r(94)("Promise"),a=r(6).Promise,p(p.S+p.F*!x,"Promise",{reject:function(e){var t=M(this);return(0,t.reject)(e),t.promise}}),p(p.S+p.F*(s||!x),"Promise",{resolve:function(e){return P(s&&this===a?E:this,e)}}),p(p.S+p.F*!(x&&r(95)(function(e){E.all(e).catch(A)})),"Promise",{all:function(e){var t=this,r=M(t),n=r.resolve,i=r.reject,o=_(function(){var r=[],o=0,a=1;g(e,!1,function(e){var s=o++,u=!1;r.push(void 0),a++,t.resolve(e).then(function(e){u||(u=!0,r[s]=e,--a||n(r))},i)}),--a||n(r)});return o.e&&i(o.v),r.promise},race:function(e){var t=this,r=M(t),n=r.reject,i=_(function(){g(e,!1,function(e){t.resolve(e).then(r.resolve,n)})});return i.e&&n(i.v),r.promise}})},function(e,t){e.exports=function(e,t,r,n){if(!(e instanceof t)||void 0!==n&&n in e)throw TypeError(r+": incorrect invocation!");return e}},function(e,t,r){var n=r(19),i=r(87),o=r(88),a=r(9),s=r(34),u=r(89),c={},l={},t=e.exports=function(e,t,r,p,f){var d,y,g,h,m=f?function(){return e}:u(e),v=n(r,p,t?2:1),b=0;if("function"!=typeof m)throw TypeError(e+" is not iterable!");if(o(m)){for(d=s(e.length);d>b;b++)if((h=t?v(a(y=e[b])[0],y[1]):v(e[b]))===c||h===l)return h}else for(g=m.call(e);!(y=g.next()).done;)if((h=i(g,v,y.value,t))===c||h===l)return h};t.BREAK=c,t.RETURN=l},function(e,t,r){var n=r(9);e.exports=function(e,t,r,i){try{return i?t(n(r)[0],r[1]):t(r)}catch(t){var o=e.return;throw void 0!==o&&n(o.call(e)),t}}},function(e,t,r){var n=r(20),i=r(2)("iterator"),o=Array.prototype;e.exports=function(e){return void 0!==e&&(n.Array===e||o[i]===e)}},function(e,t,r){var n=r(24),i=r(2)("iterator"),o=r(20);e.exports=r(6).getIteratorMethod=function(e){if(void 0!=e)return e[i]||e["@@iterator"]||o[n(e)]}},function(e,t){e.exports=function(e,t,r){var n=void 0===r;switch(t.length){case 0:return n?e():e.call(r);case 1:return n?e(t[0]):e.call(r,t[0]);case 2:return n?e(t[0],t[1]):e.call(r,t[0],t[1]);case 3:return n?e(t[0],t[1],t[2]):e.call(r,t[0],t[1],t[2]);case 4:return n?e(t[0],t[1],t[2],t[3]):e.call(r,t[0],t[1],t[2],t[3])}return e.apply(r,t)}},function(e,t,r){var n=r(3),i=r(51).set,o
